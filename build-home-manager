#!/bin/sh

system=$(uname -mo)
nix_arch=$system
username=${LOGNAME:-$(whoami)}

if [ "$system" = "Darwin arm64" ]; then
  nix_arch=aarch64-darwin
elif [ "$system" = "x86_64 GNU/Linux" ]; then
  nix_arch=x86_64-linux
else
  nix_arch=aarch64-linux
fi

( cd $HOME/.config/home-manager && home-manager switch --flake .#${username}@${nix_arch} )
